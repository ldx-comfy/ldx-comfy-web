---
import { getTranslator } from '@gudupao/astro-i18n';

interface Props {
  placeholder?: string;
  initialValue?: string;
  rows?: number;
  maxLength?: number;
}

const { placeholder = "請輸入提示詞...", initialValue = "", rows = 4, maxLength = 500 } = Astro.props;

// Get language from params or cookie
const lang = Astro.params.lang || Astro.cookies.get('lang')?.value || 'en';
const t = getTranslator(lang);
---

<div class="prompt-card">
  <div class="header">
    <h2 class="title">{placeholder || t('promptinput.title')}</h2>
  </div>

  <textarea
    id="prompt-input"
    name="prompt"
    placeholder={placeholder || t('promptinput.placeholder')}
    rows={rows}
    maxlength={maxLength}
    class="prompt-textarea"
  >{initialValue}</textarea>
</div>

<style>
  .prompt-card {
    width: 100%;
    max-width: 320px;
    margin: 2rem auto;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border-radius: 1.5rem;
    box-shadow: 0 10px 25px var(--shadow-light);
    border: 1px solid var(--border-color);
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    transition: all 0.3s ease;
  }

  .header {
    text-align: center;
  }

  .title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-primary);
    transition: color 0.3s ease;
    margin: 0;
  }

  .prompt-textarea {
    width: 100%;
    padding: 0.75rem;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    border-radius: 0.5rem;
    font-size: 1rem;
    resize: none;
    transition: all 0.3s ease;
    font-family: inherit;
  }

  .prompt-textarea::placeholder {
    color: var(--text-muted);
  }

  .prompt-textarea:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .prompt-card {
      max-width: 280px;
      margin: 1.5rem auto;
      padding: 1.25rem;
    }

    .title {
      font-size: 1rem;
    }

    .prompt-textarea {
      font-size: 16px; /* Prevent zoom on iOS */
    }
  }
</style>